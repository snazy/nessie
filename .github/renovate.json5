{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "config:base",
    // https://docs.renovatebot.com/presets-npm/
    "npm:unpublishSafe",
  ],

  "labels": ["dependencies"],

  packageRules: [
    // Check for updates, merge automatically
    {
      matchManagers: ["maven", "gradle", "gradle-wrapper", "npm", "pip_requirements", "pip_setup"],
      matchUpdateTypes: ["minor", "patch", "pin", "digest"],
      automerge: true
    },

    // Check for major updates, but do not merge automatically
    {
      matchManagers: ["maven", "gradle", "gradle-wrapper", "npm", "pip_requirements", "pip_setup"],
      matchUpdateTypes: ["major"],
      automerge: false
    },

    // Exclude a couple packages that are known to break Nessie and/or downstream users
    {
      matchManagers: ["maven", "gradle"],
      matchPackageNames: [
        "io.delta:delta-core_2.12",
        "jakarta.validation:jakarta.validation-api",
        "jakarta.enterprise:jakarta.enterprise.cdi-api",
        "org.glassfish.jersey:jersey-bom"
      ],
      "matchUpdateTypes": ["minor", "patch", "pin", "digest"]
    }
  ],

  // By default Renovate rebases PRs when the target branch has changed, we only want to rebase
  // on conflict due to the amount of dependency updates.
  rebaseWhen: "conflicted",

  // Max 50 PRs in total, 10 per hour
  prConcurrentLimit: 50,
  prHourlyLimit: 10
}
